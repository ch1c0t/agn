// Generated by CoffeeScript 2.5.1
(function() {
  var Api, Functions, ensureDirExists, fs, fun;

  fs = require('fs');

  ({fun} = require('./fun'));

  ({ensureDirExists} = require('./util'));

  Api = function() {
    var functions, types;
    return ({functions, types} = this);
  };

  Functions = function() {};

  exports.Server = fun({
    init: {
      name: function() {
        return this;
      },
      api: Api,
      functions: Functions
    },
    once: function() {
      this.PackageContent = JSON.stringify({
        name: `${this.name}.server`
      });
      this.createPackageFile = function() {
        return fs.writeFileSync(`${this.dir}/package.json`, this.PackageContent);
      };
      this.createCoffeeFile = function() {
        return console.log(`from createCoffeeFile ${this.dir}`);
      };
      this.createJSFile = function() {
        return console.log(`from createJSFile ${this.dir}`);
      };
      return this.inside = function(dir, fn) {
        var copy;
        ensureDirExists(dir);
        copy = Object.assign({}, this);
        copy.dir = dir;
        return fn.call(copy);
      };
    },
    call: function({dir}) {
      return this.inside(dir, function() {
        this.createPackageFile();
        this.createCoffeeFile();
        return this.createJSFile();
      });
    }
  });

}).call(this);
